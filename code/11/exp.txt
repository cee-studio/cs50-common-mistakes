`cursor` are advanced twice in the for loop. the condition check `for (..; cursor; ..)` fails to exit when cursor is NULL. 
